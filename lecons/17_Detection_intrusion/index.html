
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Étienne Rivard">
      
      
        <link rel="canonical" href="https://piratage.kerzo.ca/lecons/17_Detection_intrusion/">
      
      
        <link rel="prev" href="../14_Tests_penetration/">
      
      
        <link rel="next" href="../18_Lois/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.21">
    
    
      
        <title>Détection d'intrusion - Cours de piratage éthique</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.66ac8b77.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#detection-dintrusion" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Cours de piratage éthique" class="md-header__button md-logo" aria-label="Cours de piratage éthique" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cours de piratage éthique
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Détection d'intrusion
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Cours de piratage éthique" class="md-nav__button md-logo" aria-label="Cours de piratage éthique" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Cours de piratage éthique
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Page principale
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../horaire/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Horaire
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Leçons
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Leçons
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01b_Mots_de_passe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mots de passe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_Reconnaissance_passive/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reconnaissance passive
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03_Reconnaissance_active/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reconnaissance active
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04_Ecoute_reseau/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Écoute du réseau
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05_Gestion_de_risques/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gestion de risques
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_Intro_Metasploit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction à Metasploit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07_Strategies_sauvegarde/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stratégies de sauvegarde
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08_Pare_feu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pare-feux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11_Inventaire_Actifs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inventaire d'actifs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../19_Vulnerabilites_Web/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnérabilités Web
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20_Injection_SQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injections SQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10_Cryptographie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cryptographie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../13_Penetration_reseau_sans_fils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pénétration de réseaux sans-fils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../14_Tests_penetration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tests de pénétration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Détection d'intrusion
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Détection d'intrusion
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#snort" class="md-nav__link">
    <span class="md-ellipsis">
      Snort
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pour-demarrer-snort" class="md-nav__link">
    <span class="md-ellipsis">
      Pour démarrer Snort
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regles-de-snort" class="md-nav__link">
    <span class="md-ellipsis">
      Règles de snort
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Règles de snort">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#actions" class="md-nav__link">
    <span class="md-ellipsis">
      Actions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protocoles" class="md-nav__link">
    <span class="md-ellipsis">
      Protocoles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adresses" class="md-nav__link">
    <span class="md-ellipsis">
      Adresses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ports" class="md-nav__link">
    <span class="md-ellipsis">
      Ports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#la-direction" class="md-nav__link">
    <span class="md-ellipsis">
      La direction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#options" class="md-nav__link">
    <span class="md-ellipsis">
      Options
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#options-generales" class="md-nav__link">
    <span class="md-ellipsis">
      Options générales
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options-payload" class="md-nav__link">
    <span class="md-ellipsis">
      Options payload
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options-non-payload" class="md-nav__link">
    <span class="md-ellipsis">
      Options non-payload
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options-post-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Options post-detection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fichier-dhistorique" class="md-nav__link">
    <span class="md-ellipsis">
      Fichier d'historique
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quelques-trucs" class="md-nav__link">
    <span class="md-ellipsis">
      Quelques trucs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quelques-regles" class="md-nav__link">
    <span class="md-ellipsis">
      Quelques règles
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quelques règles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#detecter-un-scan-nmap-des-ports-tcp-dun-serveur" class="md-nav__link">
    <span class="md-ellipsis">
      Détecter un scan NMAP des ports TCP d'un serveur.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detecter-un-essai-de-se-connecter-en-ftp-avec-root" class="md-nav__link">
    <span class="md-ellipsis">
      Détecter un essai de se connecter en FTP avec root
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detecter-un-login-de-telnet-invalide" class="md-nav__link">
    <span class="md-ellipsis">
      Détecter un login de telnet invalide
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testez-vos-connaissances" class="md-nav__link">
    <span class="md-ellipsis">
      Testez vos connaissances
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../18_Lois/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lois
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09_Antivirus_et_PDF_malicieux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Antivirus et PDF malicieux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10_Hameconnage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hameçonnage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21_Securiser_Apache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sécuriser serveur Apache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22_Programmer_application_securisee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Programmer application sécurisée
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23_Protection_Injection_SQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Protection injection SQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24_Chiffrement_et_donnees_sensibles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chiffrement et données sensibles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../25_Authentification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../99_CacherCodeMalicieux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cacher du code malicieux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../99_Attaque_Uber/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attaque de Uber
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Exercices
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Exercices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/01_Exercices_Laboratoire/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bâtir le laboratoire
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/02_Exercices_Reconnaissance_passive/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reconnaissance passive
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/03_Reconnaissance_active/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reconnaissance active
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/04_Ecoute_reseau/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Écoute du réseau
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/05_Gestion_de_risques/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gestion du risque
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/06_Intro_Metasploit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro à Metasploit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/07_strategie_sauvegarde/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stratégie de sauvegarde
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/08_Pare_feu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pare-feux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/10_classification_actifs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Classification d'actifs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/19_Vulnerabilites_Web/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnérabilités Web
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/20_Injection_SQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injections SQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/10_Cryptographie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cryptographie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/13_Penetration_reseau_sans_fils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pénétration réseau sans-fils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/14_Tests_penetration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tests de pénétration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/17_Detection_intrusion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Détection d'intrusion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/18_Lois/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lois
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/09_PDF_Malicieux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PDF Malicieux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/10_Hameconnage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hameçonnage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/21_Securiser_Apache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sécuriser serveur Apache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/22_Programmer_application_securisee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Programmer application sécurisée
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/23_Proteger_injection_SQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Protection injection SQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/24_Chiffrement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chiffrement
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercices/25_Authentification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentification
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Outils
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Outils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outils/cartographie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cartographie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Labo
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Labo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labo/Installation_Kali_VirtualBox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kali
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labo/Installation_Metasploitable_VirtualBox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metasploitable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labo/Installation_WindowsXP_VirtualBox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows XP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labo/Installation_Gogo_VirtualBox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gogo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labo/Installation_DunderMifflin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dundermifflin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labo/Installation_Snort_VirtualBox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Snort
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labo/Installation_MonMur_VirtualBox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MonMur
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labo/capturer_trafic_virtualbox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Capturer le trafic dans VirtualBox
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labo/kali_demarrer_bd_postgresql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Démarrer PostGreSQL
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Évaluations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Évaluations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluations/evaluation_sommative/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Évaluation sommative
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluations/examen_mi_session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examen mi-session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluations/Hack_lab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hack Lab
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#snort" class="md-nav__link">
    <span class="md-ellipsis">
      Snort
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pour-demarrer-snort" class="md-nav__link">
    <span class="md-ellipsis">
      Pour démarrer Snort
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regles-de-snort" class="md-nav__link">
    <span class="md-ellipsis">
      Règles de snort
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Règles de snort">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#actions" class="md-nav__link">
    <span class="md-ellipsis">
      Actions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protocoles" class="md-nav__link">
    <span class="md-ellipsis">
      Protocoles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adresses" class="md-nav__link">
    <span class="md-ellipsis">
      Adresses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ports" class="md-nav__link">
    <span class="md-ellipsis">
      Ports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#la-direction" class="md-nav__link">
    <span class="md-ellipsis">
      La direction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#options" class="md-nav__link">
    <span class="md-ellipsis">
      Options
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#options-generales" class="md-nav__link">
    <span class="md-ellipsis">
      Options générales
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options-payload" class="md-nav__link">
    <span class="md-ellipsis">
      Options payload
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options-non-payload" class="md-nav__link">
    <span class="md-ellipsis">
      Options non-payload
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options-post-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Options post-detection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fichier-dhistorique" class="md-nav__link">
    <span class="md-ellipsis">
      Fichier d'historique
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quelques-trucs" class="md-nav__link">
    <span class="md-ellipsis">
      Quelques trucs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quelques-regles" class="md-nav__link">
    <span class="md-ellipsis">
      Quelques règles
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quelques règles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#detecter-un-scan-nmap-des-ports-tcp-dun-serveur" class="md-nav__link">
    <span class="md-ellipsis">
      Détecter un scan NMAP des ports TCP d'un serveur.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detecter-un-essai-de-se-connecter-en-ftp-avec-root" class="md-nav__link">
    <span class="md-ellipsis">
      Détecter un essai de se connecter en FTP avec root
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detecter-un-login-de-telnet-invalide" class="md-nav__link">
    <span class="md-ellipsis">
      Détecter un login de telnet invalide
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testez-vos-connaissances" class="md-nav__link">
    <span class="md-ellipsis">
      Testez vos connaissances
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="detection-dintrusion">Détection d'intrusion</h1>
<p>Pour bien protéger un réseau d'entreprise, il est important d'avoir une visibilité sur les activités dans ce réseau.</p>
<p>Des systèmes nommés IDS (<em>Intrusion Detection System</em>) écoutent toutes les communications d'un réseau et lancent une alerte lorsqu'une activité suspecte survient.</p>
<p>D'autres systèmes sont plus avancés et permettent de prévenir une intrusion dès qu'une attaque est détectée, les IPS (<em>Intrusion Prevention System</em>). Les IPS sont normalement connectés au pare-feu ou au commutateur réseau pour terminer les communications jugées suspectes.</p>
<p>Principalement, un IDS écoute le réseau comme le fait Wireshark. Il peut détecter une attaque de deux façons :</p>
<ol>
<li>Selon un ensemble de règles,</li>
<li>Selon une détection de comportement.</li>
</ol>
<p>La détection par règles implique que l'opérateur du IDS écrit chaque règle qu'il veut détecter. Ce peut être par exemple pour détecter un système qui fait un ICMP ping (lors de la reconnaissance active) ou l'utilisation de services spécifiques.</p>
<p>La détection par comportement implique un moteur intelligent qui apprend ce que les systèmes font normalement et réagit lorsque ces systèmes agissent différemment. Ex :</p>
<p>Un poste de travail accède à des fichiers sur le serveur (service SMB, port 445) à chaque jour. Un jour, ce poste essaie de se connecter en SSH, puis en Telnet. Comme ce n'est pas usuel, l'IDS identifierait le poste comme suspicieux.</p>
<h2 id="snort">Snort</h2>
<p><img alt="17-snort-logo" src="../../images/2020/07/17-snort-logo.png" /></p>
<p>Snort est un IDS/IPS Open-Source très populaire sur le marché. Il fonctionne selon un ensemble de règles.</p>
<p>Le fichier de configuration se trouve ici :  </p>
<p><code>/etc/snort/snort.conf</code></p>
<p><img alt="17-snort-conf" src="../../images/2020/07/17-snort-conf.png" /></p>
<p>Il est important que l'adresse HOME_NET corresponde à l'adresse de votre serveur. Pour trouver l'adresse de votre serveur :  </p>
<p><code>ip addr</code></p>
<p><img alt="17-ip-addr" src="../../images/2020/07/17-ip-addr.png" /></p>
<p>Pour tester la configuration, utilisez la commande suivante :  </p>
<p><code>snort -T -c /etc/snort/snort.conf</code></p>
<h2 id="pour-demarrer-snort">Pour démarrer Snort</h2>
<p><code>snort -A console -i enp0s7 -u snort -g snort -c /etc/snort/snort.conf</code> . </p>
<p>Truc: Créez un fichier bash avec la commande! (dans mon cas c'est <code>startsnort</code>)   </p>
<h2 id="regles-de-snort">Règles de snort</h2>
<p>Snort fonctionne avec des règles. Les règles sont ajoutées au fichier <code>/etc/snort/rules/local.rules</code>. Par défaut, le fichier est vide.</p>
<p>Écrivons notre première règle :  </p>
<p><code>alert icmp any any -&gt; any any (msg:"Test ICMP"; sid:10000001; rev:001;)</code></p>
<p>Voici la structure de la règle :  </p>
<p><img alt="17-snort-rule-structure" src="../../images/2020/07/17-snort-rule-structure.png" /></p>
<h3 id="actions">Actions</h3>
<p>Voici les actions possibles avec Snort :  </p>
<ol>
<li>alert - génère une alerte et écrit le paquet dans l'historique  </li>
<li>log - écrit le paquet dans l'historique  </li>
<li>pass - ignore le paquet  </li>
<li>drop - bloque et écrit le paquet dans l'historique  </li>
<li>reject - bloque le paquet, écrit le paquet dans l'historique et envoi un TCP reset  </li>
<li>sdrop - bloque le paquet sans l'écrire dans l'historique  </li>
</ol>
<h3 id="protocoles">Protocoles</h3>
<p>Il y a 4 protocoles disponibles avec Snort : TCP, UDP, ICMP et IP.  </p>
<h3 id="adresses">Adresses</h3>
<p>Les adresses sont sous le format CIDR :  </p>
<table>
<thead>
<tr>
<th>CIDR</th>
<th>Plage</th>
</tr>
</thead>
<tbody>
<tr>
<td>192.168.40.0/24</td>
<td>192.168.40.1 à 192.168.40.255</td>
</tr>
<tr>
<td>192.168.40.5/32</td>
<td>192.168.40.5 seulement</td>
</tr>
<tr>
<td>any</td>
<td>n'importe quelle adresse IP</td>
</tr>
</tbody>
</table>
<p>Pour exclure une plage d'adresses, utiliser le ! comme ceci :  </p>
<p><code>!192.168.40.0/24</code>  veut dire toutes les adresses sauf celles entre 192.168.40.1 et 192.168.40.255.</p>
<h3 id="ports">Ports</h3>
<p>Vous pouvez spécifier les ports de la manière suivante :  </p>
<table>
<thead>
<tr>
<th>Ports</th>
<th>Plage</th>
</tr>
</thead>
<tbody>
<tr>
<td>any</td>
<td>n'importe quel port</td>
</tr>
<tr>
<td>21</td>
<td>seulement le port 21</td>
</tr>
<tr>
<td>1:1000</td>
<td>tous les ports entre 1 et 1000</td>
</tr>
<tr>
<td>1000:</td>
<td>tous les ports plus grand ou égal à 1000</td>
</tr>
<tr>
<td>:500</td>
<td>tous les ports plus petit ou égal à 500</td>
</tr>
<tr>
<td>!21</td>
<td>tous les ports sauf le port 21</td>
</tr>
</tbody>
</table>
<h3 id="la-direction">La direction</h3>
<p>Vous pouvez spécifier la direction de la manière suivante :  </p>
<table>
<thead>
<tr>
<th>Direction</th>
<th>Signification</th>
</tr>
</thead>
<tbody>
<tr>
<td>-&gt;</td>
<td>communication de l'adresse source vers l'adresse de destination</td>
</tr>
<tr>
<td>&lt;&gt;</td>
<td>communication de l'adresse source vers l'adresse de destination et la communication de la destination vers la source</td>
</tr>
</tbody>
</table>
<p>Astuce : La direction &lt;&gt; peut être utile pour conserver la conversation entre deux adresses, par exemple une conversation telnet :  </p>
<p><code>log tcp 192.168.40.0/24 any &lt;&gt; 192.168.40.0/24 23</code></p>
<h2 id="options">Options</h2>
<p>Il y a 4 catégories d'options aux règles :  </p>
<table>
<thead>
<tr>
<th>Catégorie</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>general</td>
<td>Information à propos de la règle, aucun effet durant la détection</td>
</tr>
<tr>
<td>payload</td>
<td>Inspecte le contenu d'un paquet</td>
</tr>
<tr>
<td>non-payload</td>
<td>Inspecte les informations du paquet autre que le contenu</td>
</tr>
<tr>
<td>post-detection</td>
<td>Déclencheurs qui surviennent après exécution de la règle</td>
</tr>
</tbody>
</table>
<h3 id="options-generales">Options générales</h3>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
<th>Exemple</th>
</tr>
</thead>
<tbody>
<tr>
<td>msg</td>
<td>Imprime un message en même temps que le détail du paquet</td>
<td><code>log tcp any any -&gt; any 21 (msg:"Utilisation de FTP";)</code></td>
</tr>
<tr>
<td>sid</td>
<td>Pour identifier de manière unique une règle. Utiliser &gt; 1 000 000 pour vos règles locales</td>
<td><code>log tcp any any -&gt; any 21 (sid:1000002;)</code></td>
</tr>
</tbody>
</table>
<h3 id="options-payload">Options payload</h3>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
<th>Exemple</th>
</tr>
</thead>
<tbody>
<tr>
<td>content</td>
<td>Examine le contenu du paquet</td>
<td><code>log tcp any any -&gt; any 80 (content:"GET"; msg:"Utilisation de HTTP";)</code></td>
</tr>
<tr>
<td>pcre</td>
<td>Examine le contenu du paquet avec un <em>regex</em></td>
<td><code>log tcp any any -&gt; any 21 (pcre:"/user\s+root/i"; msg:"Utilisation de FTP avec user root";)</code></td>
</tr>
</tbody>
</table>
<h3 id="options-non-payload">Options non-payload</h3>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
<th>Exemple</th>
</tr>
</thead>
<tbody>
<tr>
<td>ttl</td>
<td>Examine le <em>time to live</em></td>
<td><code>log ip any any -&gt; any any (ttl:&lt;3; sid:100000001;)</code></td>
</tr>
<tr>
<td>flags</td>
<td>Examine quel sémaphore est allumé</td>
<td><code>log ip any any -&gt; any any (flags:SF; sid:100000001;)</code></td>
</tr>
</tbody>
</table>
<h3 id="options-post-detection">Options post-detection</h3>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
<th>Exemple</th>
</tr>
</thead>
<tbody>
<tr>
<td>session</td>
<td>Écrit dans l'historique le contenu de la session</td>
<td><code>log tcp any any -&gt; any 23 (session:printable; sid:100000001;)</code></td>
</tr>
<tr>
<td>detection_filter</td>
<td>Définit le nombre d'occurence avant de déclencher une alerte</td>
<td><code>alert icmp any any -&gt; any any (detection_filter:track by_src, count 30, seconds 60;sid:100000001;)</code></td>
</tr>
</tbody>
</table>
<h2 id="fichier-dhistorique">Fichier d'historique</h2>
<p>Les fichiers d'historique se trouvent dans le répertoire suivant :  </p>
<p><code>/var/log/snort</code></p>
<p>Pour visualiser l'historique (qui est en fait un fichier pcap), deux choix :  </p>
<ol>
<li>utiliser la commande <code>snort -r &lt;nom fichier&gt;</code></li>
<li>Transférer le fichier dans Wireshark</li>
</ol>
<h2 id="quelques-trucs">Quelques trucs</h2>
<ol>
<li>N'activer les règles que pour l'équipement que vous voulez protéger. Pas de serveur Web? n'activez pas les règles qui les concernent</li>
<li>Écrire les règles qui attaquent une vulnérabilité, pas pour détecter un <em>payload</em>. Les pirates peuvent changer la signature du <em>payload</em>, mais pas celle de la vulnérabilité.</li>
</ol>
<h2 id="quelques-regles">Quelques règles</h2>
<h3 id="detecter-un-scan-nmap-des-ports-tcp-dun-serveur">Détecter un scan NMAP des ports TCP d'un serveur.</h3>
<p><code>alert tcp any any -&gt; any any (flags:S; detection_filter:track by_src, count 1000, seconds 60; msg:"NMAP Syn Scan"; sid:1000001;)</code></p>
<p>Testons la règle :</p>
<p><img alt="17-nmap-syn-scan" src="../../images/2020/07/17-nmap-syn-scan.png" /></p>
<p>La réaction de snort :  </p>
<p><img alt="17-nmap-syn-scan-snort" src="../../images/2020/07/17-nmap-syn-scan-snort.png" /></p>
<h3 id="detecter-un-essai-de-se-connecter-en-ftp-avec-root">Détecter un essai de se connecter en FTP avec root</h3>
<pre><code>alert tcp any any -&gt; any 21 ( \
  pcre:&quot;/user\s+root/i&quot;; \
  sid: 1000002; \
  msg:&quot;Utilisation de FTP avec user root&quot;;)
</code></pre>
<p>Testons la règle :  </p>
<p><img alt="17-connect-ftp-root" src="../../images/2020/07/17-connect-ftp-root.png" /></p>
<p>La réaction de snort :  </p>
<p><img alt="17-snort-react-ftp-root" src="../../images/2020/07/17-snort-react-ftp-root.png" /></p>
<h3 id="detecter-un-login-de-telnet-invalide">Détecter un login de telnet invalide</h3>
<pre><code>alert tcp any 23 -&gt; any any ( \
  content:&quot;Login incorrect&quot;; \
  sid: 1000003; \
  msg:&quot;Essai de login TELNET invalide&quot;;)
</code></pre>
<p>Testons la règle :  </p>
<p><img alt="17-telnet-login" src="../../images/2020/07/17-telnet-login.png" /></p>
<p>La réaction de snort :  </p>
<p><img alt="17-telnet-login-snort" src="../../images/2020/07/17-telnet-login-snort.png" /></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Prenez quelques minutes pour faire votre <a href="../../outils/cartographie/">cartographie</a> de la leçon d'aujourd'hui!   </p>
</div>
<h2 id="testez-vos-connaissances">Testez vos connaissances</h2>
<p><a href="https://forms.office.com/r/VzpVFmG3hm">Petit quiz de la détection d'intrusion</a>  </p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.a7c05c9e.min.js"></script>
      
        <script src="../../javascript/linktarget.js"></script>
      
    
  </body>
</html>